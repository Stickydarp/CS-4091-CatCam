version: "3.8"
services:
  backend:
    build:
      context: ./externalServer
      dockerfile: Backend.Dockerfile
    container_name: catcam-backend
    working_dir: /app
    # Mount repo-local catcam_data so images and DB live in the repository folder
    volumes:
      - ./externalServer:/app:delegated
      - ./catcam_data/images:/catCamData/images
      - ./catcam_data/metadata:/catCamData/metadata
    command: tail -f /dev/null
    ports:
      - "8000:8000"
    tty: true
    stdin_open: true
  frontend:
    build:
      context: ./externalServer
      dockerfile: Frontend.Dockerfile
    container_name: catcam-frontend
    tty: true
    stdin_open: true
    working_dir: /app
    command: npm run dev
    ports:
      - "3000:3000"
    # Mount repo-local data so frontend can read images/metadata during development
    volumes:
      - ./catcam_data/images:/catCamData/images:ro
      - ./catcam_data/metadata:/catCamData/metadata:ro
